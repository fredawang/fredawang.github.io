<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>那些年我们一起清除过的浮动 | 水滴石穿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="水滴石穿">
  <meta name="discription" content="这个一个前段工程师的博客">
  <meta name="description" content=".article-entry img{    margin-left:0;}浮动(float)，一个我们即爱又恨的属性。爱，因为通过浮动，我们能很方便地布局； 恨，浮动之后遗留下来太多的问题需要解决，特别是IE6-7（以下无特殊说明均指 windows 平台的 IE浏览器）。也许很多人都有这样的疑问，浮动从何而来？我们为何要清除浮动？清除浮动的原理是什么？本文将一步一步地深入剖析其中的奥秘，让浮动">
<meta property="og:type" content="article">
<meta property="og:title" content="那些年我们一起清除过的浮动">
<meta property="og:url" content="http://fredawang.github.io/2015/03/12/清除浮动/">
<meta property="og:site_name" content="水滴石穿">
<meta property="og:description" content=".article-entry img{    margin-left:0;}浮动(float)，一个我们即爱又恨的属性。爱，因为通过浮动，我们能很方便地布局； 恨，浮动之后遗留下来太多的问题需要解决，特别是IE6-7（以下无特殊说明均指 windows 平台的 IE浏览器）。也许很多人都有这样的疑问，浮动从何而来？我们为何要清除浮动？清除浮动的原理是什么？本文将一步一步地深入剖析其中的奥秘，让浮动">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="那些年我们一起清除过的浮动">
<meta name="twitter:description" content=".article-entry img{    margin-left:0;}浮动(float)，一个我们即爱又恨的属性。爱，因为通过浮动，我们能很方便地布局； 恨，浮动之后遗留下来太多的问题需要解决，特别是IE6-7（以下无特殊说明均指 windows 平台的 IE浏览器）。也许很多人都有这样的疑问，浮动从何而来？我们为何要清除浮动？清除浮动的原理是什么？本文将一步一步地深入剖析其中的奥秘，让浮动">

  
    <link rel="alternative" href="/atom.xml" title="水滴石穿" type="application/atom+xml">
  
  
    <link rel="icon" href="css/images/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">水滴石穿</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">水非石之钻，索非木之锯，渐靡使之然也</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav" style="display:none;">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <!--<nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>-->
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://fredawang.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-清除浮动" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/12/清除浮动/" class="article-date">
  <time datetime="2015-03-12T12:00:00.000Z" itemprop="datePublished">3月 12 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CSS/">CSS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      那些年我们一起清除过的浮动
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><style type="text/css"><br>.article-entry img{<br>    margin-left:0;<br>}<br></style><br>浮动(float)，一个我们即爱又恨的属性。爱，因为通过浮动，我们能很方便地布局； 恨，浮动之后遗留下来太多的问题需要解决，特别是IE6-7（以下无特殊说明均指 windows 平台的 IE浏览器）。也许很多人都有这样的疑问，浮动从何而来？我们为何要清除浮动？清除浮动的原理是什么？本文将一步一步地深入剖析其中的奥秘，让浮动使用起来更加得心应手。<br><a id="more"></a></p>
<h2 id="一、清除浮动_还是_闭合浮动_（Enclosing_float_or_Clearing_float）？">一、清除浮动 还是 闭合浮动 （Enclosing float or Clearing float）？</h2>
<p>很多人都已经习惯称之为清除浮动，以前我也一直这么叫着，但是确切地来说是不准确的。我们应该用严谨的态度来对待代码，也能更好地帮助我们理解开头的三个问题。</p>
<p>1）清除浮动：清除对应的单词是 clear，对应CSS中的属性是 clear：left | right | both | none；</p>
<p>2）闭合浮动：更确切的含义是使浮动元素闭合，从而减少浮动带来的影响。</p>
<p>通过以上实例发现，其实我们想要达到的效果更确切地说是闭合浮动，而不是单纯的清除浮动，在footer上设置clear：both清除浮动并不能解决warp高度塌陷的问题。  </p>
<p>结论：用闭合浮动比清除浮动更加严谨，所以后文中统一称之为：闭合浮动。</p>
<h2 id="二、为何要闭合浮动？">二、为何要闭合浮动？</h2>
<p>要解答这个问题，我们得先说说CSS中的定位机制：普通流，浮动，绝对定位 （其中”position:fixed” 是 “position:absolute” 的一个子类）。</p>
<p>1）普通流：很多人或者文章称之为文档流或者普通文档流，其实标准里根本就没有这个词。如果把文档流直译为英文就是 document flow ，但标准里只有另一个词，叫做 普通流 （normal flow)，或者称之为常规流。但似乎大家更习惯文档流的称呼，因为很多中文翻译的书就是这么来的。比如《CSS Mastery》，英文原书中至始至终都只有普通流 normal flow（普通流） 这一词，从来没出现过document flow （文档流）</p>
<p>2）浮动：浮动的框可以左右移动，直至它的外边缘遇到包含框或者另一个浮动框的边缘。浮动框不属于文档中的普通流，当一个元素浮动之后，不会影响到块级框的布局而只会影响内联框（通常是文本）的排列，文档中的普通流就会表现得和浮动框不存在一样，当浮动框高度超出包含框的时候，也就会出现包含框不会自动伸高来闭合浮动元素（“高度塌陷”现象）。顾名思义，就是漂浮于普通流之上，像浮云一样，但是只能左右浮动。</p>
<p>正是因为浮动的这种特性，导致本属于普通流中的元素浮动之后，包含框内部由于不存在其他普通流元素了，也就表现出高度为0（高度塌陷）。在实际布局中，往往这并不是我们所希望的，所以需要闭合浮动元素，使其包含框表现出正常的高度。</p>
<p>绝对定位就不多说了，不在本文讨论范围之内，下回分解。</p>
<h2 id="三、闭合浮动的原理——了解_hasLayout_和_Block_formatting_contexts">三、闭合浮动的原理——了解 hasLayout 和 Block formatting contexts</h2>
<p>先看一下清理浮动的各种方法：</p>
<h4 id="1_添加额外标签">1 添加额外标签</h4>
<p>这是在学校老师就告诉我们的 一种方法，通过在浮动元素末尾添加一个空的标签例如 <div style="”clear:both”"></div>，其他标签br等亦可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;div class=<span class="string">"warp"</span> id=<span class="string">"float1"</span>&gt;</div><div class="line"></div><div class="line">    &lt;h2&gt;<span class="number">1</span>）添加额外标签&lt;/h2&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"main left"</span>&gt;.main{float:left;}&lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"side left"</span>&gt;.side{float:right;}&lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;div style=<span class="string">"clear:both;"</span>&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div class=<span class="string">"footer"</span>&gt;.footer&lt;/div&gt;</div></pre></td></tr></table></figure>

<p>优点：通俗易懂，容易掌握</p>
<p>缺点：可以想象通过此方法，会添加多少无意义的空标签，有违结构与表现的分离，在后期维护中将是噩梦，这是坚决不能忍受的，所以你看了这篇文章之后还是建议不要用了吧。</p>
<h4 id="2_使用_br标签和其自身的_html属性">2 使用 br标签和其自身的 html属性</h4>
<p>这个方法有些小众，br 有 clear=“all | left | right | none” 属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;div class=<span class="string">"warp"</span> id=<span class="string">"float2"</span>&gt;</div><div class="line"></div><div class="line">    &lt;h2&gt;<span class="number">2</span>）使用 br标签和其自身的 html属性&lt;/h2&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"main left"</span>&gt;.main{float:left;}&lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"side left"</span>&gt;.side{float:right;}&lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;br clear=<span class="string">"all"</span> /&gt;</div><div class="line"></div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div class=<span class="string">"footer"</span>&gt;.footer&lt;/div&gt;</div></pre></td></tr></table></figure>

<p>优点：比空标签方式语义稍强，代码量较少</p>
<p>缺点：同样有违结构与表现的分离，不推荐使用</p>
<h4 id="3_父元素设置_overflow：hidden">3 父元素设置 overflow：hidden</h4>
<p>通过设置父元素overflow值设置为hidden；在IE6中还需要触发 hasLayout ，例如 zoom：1；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;div class=<span class="string">"warp"</span> id=<span class="string">"float3"</span> style=<span class="string">"overflow:hidden; *zoom:1;"</span>&gt;</div><div class="line"></div><div class="line">    &lt;h2&gt;<span class="number">3</span>)父元素设置 overflow &lt;/h2&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"main left"</span>&gt;.main{float:left;}&lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;div class=<span class="string">"side left"</span>&gt;.side{float:right;}&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div class=<span class="string">"footer"</span>&gt;.footer&lt;/div&gt;</div></pre></td></tr></table></figure>

<p>优点：不存在结构和语义化问题，代码量极少</p>
<p>缺点：内容增多时候容易造成不会自动换行导致内容被隐藏掉，无法显示需要溢出的元素；04年POPO就发现overflow:hidden会导致中键失效，这是我作为一个多标签浏览控所不能接受的。所以还是不要使用了</p>
<h4 id="4_父元素设置_overflow：auto_属性">4 父元素设置 overflow：auto 属性</h4>
<p>同样IE6需要触发hasLayout，演示和3差不多</p>
<p>优点：不存在结构和语义化问题，代码量极少</p>
<p>缺点：多个嵌套后，firefox某些情况会造成内容全选；IE中 mouseover 造成宽度改变时会出现最外层模块有滚动条等，firefox早期版本会无故产生focus等.</p>
<h4 id="5_父元素也设置浮动">5 父元素也设置浮动</h4>
<p>优点：不存在结构和语义化问题，代码量极少</p>
<p>缺点：使得与父元素相邻的元素的布局会受到影响，不可能一直浮动到body，不推荐使用</p>
<h4 id="6_父元素设置display:table">6 父元素设置display:table</h4>
<p>优点：结构语义化完全正确，代码量极少</p>
<p>缺点：盒模型属性已经改变，由此造成的一系列问题，得不偿失，不推荐使用</p>
<h4 id="7_使用:after_伪元素">7 使用:after 伪元素</h4>
<p>需要注意的是 :after是伪元素（Pseudo-Element），不是伪类（某些CSS手册里面称之为“伪对象”），很多闭合浮动大全之类的文章都称之为伪类，不过csser要严谨一点，这是一种态度。</p>
<p>由于IE6-7不支持:after，使用 zoom:1触发 hasLayout。</p>
<p> 该方法源自于: <a href="http://www.positioniseverything.net/easyclearing.html" target="_blank" rel="external">How To Clear Floats Without Structural Markup</a></p>
<p>原文全部代码如下:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;style <span class="built_in">type</span>=<span class="string">"text/css"</span>&gt;  </div><div class="line">    .clearfix:after {  content: <span class="string">"."</span>; display: block; height: <span class="number">0</span>; clear: both; visibility: hidden;  }   </div><div class="line">    .clearfix {display: inline-block;}  /* <span class="keyword">for</span> IE/Mac */   </div><div class="line">&lt;/style&gt; </div><div class="line">&lt;!--[<span class="keyword">if</span> IE]&gt; &lt;style <span class="built_in">type</span>=<span class="string">"text/css"</span>&gt; </div><div class="line">    .clearfix {zoom: <span class="number">1</span>;/* triggers hasLayout */  display: block;/* resets display <span class="keyword">for</span> IE/W<span class="keyword">in</span> */} </div><div class="line">&lt;/style&gt;  </div><div class="line">&lt;![endif]--&gt;  </div><div class="line">鉴于 IE/Mac的市场占有率极低,我们直接忽略掉,最后精简的代码如下:</div><div class="line">.clearfix:after {content:<span class="string">"."</span>; display:block; height:<span class="number">0</span>; visibility:hidden; clear:both; }</div><div class="line">.clearfix { *zoom:<span class="number">1</span>; }</div></pre></td></tr></table></figure>

<p>优点：结构和语义化完全正确,代码量居中</p>
<p>缺点：复用方式不当会造成代码量增加</p>
<h2 id="小结">小结</h2>
<p>通过对比，我们不难发现，其实以上列举的方法，无非有两类：</p>
<p>其一，通过在浮动元素的末尾添加一个空元素，设置 clear：both属性，after伪元素其实也是通过 content 在元素的后面生成了内容为一个点的块级元素；</p>
<p>其二，通过设置父元素 overflow 或者display：table 属性来闭合浮动，我们来探讨一下这里面的原理。</p>
<p>在CSS2.1里面有一个很重要的概念，但是国内的技术博客介绍到的比较少，那就是 Block formatting contexts （块级格式化上下文），以下简称 BFC。</p>
<p>CSS3里面对这个规范做了改动，称之为：flow root，并且对触发条件进行了进一步说明。</p>
<p>那么如何触发BFC呢？</p>
<ul>
<li><p>float 除了none以外的值</p>
</li>
<li><p>overflow 除了visible 以外的值（hidden，auto，scroll ）</p>
</li>
<li><p>display (table-cell，table-caption，inline-block)</p>
</li>
<li><p>position（absolute，fixed）</p>
</li>
<li><p>fieldset元素</p>
</li>
</ul>
<p>需要注意的是，display:table 本身并不会创建BFC，但是它会产生匿名框(anonymous boxes)，而匿名框中的display:table-cell可以创建新的BFC，换句话说，触发块级格式化上下文的是匿名框，而不是display:table。所以通过display:table和display:table-cell创建的BFC效果是不一样的。</p>
<p>fieldset元素在www.w3.org里目前没有任何有关这个触发行为的信息，直到HTML5标准里才出现。有些浏览器bugs（Webkit，Mozilla）提到过这个触发行为，但是没有任何官方声明。实际上，即使fieldset在大多数的浏览器上都能创建新的块级格式化上下文，开发者也不应该把这当做是理所当然的。CSS2.1没有定义哪种属性适用于表单控件，也没有定义如何使用CSS来给它们添加样式。用户代理可能会给这些属性应用CSS属性，建议开发者们把这种支持当做实验性质的，更高版本的CSS可能会进一步规范这个。</p>
<h2 id="BFC的特性：">BFC的特性：</h2>
<p><strong>1)块级格式化上下文会阻止外边距叠加</strong></p>
<p>当两个相邻的块框在同一个块级格式化上下文中时，它们之间垂直方向的外边距会发生叠加。换句话说，如果这两个相邻的块框不属于同一个块级格式化上下文，那么它们的外边距就不会叠加。</p>
<p><strong>2)块级格式化上下文不会重叠浮动元素</strong></p>
<p>根据规定，一个块级格式化上下文的边框不能和它里面的元素的外边距重叠。这就意味着浏览器将会给块级格式化上下文创建隐式的外边距来阻止它和浮动元素的外边距叠加。由于这个原因，当给一个挨着浮动的块级格式化上下文添加负的外边距时将会不起作用。 </p>
<p><strong>3)块级格式化上下文通常可以包含浮动</strong></p>
<p>详见： W3C CSS2.1 - 10.6.7 <a href="http://www.w3.org/TR/CSS2/visudet.html#root-height" target="_blank" rel="external">‘Auto’ heights for block formatting context roots</a> </p>
<p>通俗地来说：创建了 BFC的元素就是一个独立的盒子，里面的子元素不会在布局上影响外面的元素，反之亦然，同时BFC任然属于文档中的普通流。</p>
<p>至此，您或许明白了为什么 overflow:hidden或者auto可以闭合浮动了，真是因为父元素创建了新的BFC。对于张鑫旭在对<a href="http://www.zhangxinxu.com/wordpress/?p=621" target="_blank" rel="external">《overflow与zoom”清除浮动”的一些认识 》</a>一文中对于用包裹来解释闭合浮动的原理，我觉得是不够严谨的，而且没有依据。并且说道“Firefox等浏览器并没有haslayout的概念”，那么现代浏览器是有BFC的，从表现上来说，hasLayout 可以等同于 BFC。</p>
<p>IE6-7的显示引擎使用的是一个称为布局（layout）的内部概念，由于这个显示引擎自身存在很多的缺陷，直接导致了IE6-7的很多显示bug。当我们说一个元素“得到 layout”，或者说一个元素“拥有 layout” 的时候，我们的意思是指它的微软专有属性 hasLayout <a href="http://msdn.microsoft.com/worksh" target="_blank" rel="external">http://msdn.microsoft.com/worksh</a> … rties/haslayout.asp 为此被设为了 true 。IE6-7使用布局的概念来控制元素的尺寸和定位，那些拥有布局（have layout）的元素负责本身及其子元素的尺寸设置和定位。如果一个元素的 hasLayout 为false，那么它的尺寸和位置由最近拥有布局的祖先元素控制。</p>
<p>触发hasLayout的条件：</p>
<ul>
<li><p>position: absolute</p>
</li>
<li><p>float: left|right</p>
</li>
<li><p>display: inline-block</p>
</li>
<li><p>width: 除 “auto” 外的任意值</p>
</li>
<li><p>height: 除 “auto” 外的任意值 （例如很多人闭合浮动会用到 height: 1%  ）</p>
</li>
<li><p>zoom: 除 “normal” 外的任意值 (MSDN) <a href="http://msdn.microsoft.com/worksh" target="_blank" rel="external">http://msdn.microsoft.com/worksh</a> … properties/zoom.asp</p>
</li>
<li><p>writing-mode: tb-rl (MSDN) <a href="http://msdn.microsoft.com/worksh" target="_blank" rel="external">http://msdn.microsoft.com/worksh</a> … ies/writingmode.asp</p>
</li>
</ul>
<p>在 IE7 中，overflow 也变成了一个 layout 触发器：</p>
<ul>
<li><p>overflow: hidden|scroll|auto （ 这个属性在IE之前版本中没有触发 layout 的功能。 ）</p>
</li>
<li><p>overflow-x|-y: hidden|scroll|auto （CSS3 盒模型中的属性，尚未得到浏览器的广泛支持。他们在之前IE版本中同样没有触发 layout 的功能）</p>
</li>
</ul>
<p>hasLayout更详细的解释请参见 old9翻译的 大名鼎鼎的 《On having layout》一文（英文原文：<a href="http://www.satzansatz.de/cssd/onhavinglayout.htm）" target="_blank" rel="external">http://www.satzansatz.de/cssd/onhavinglayout.htm）</a></p>
<p>IE8使用了全新的渲染引擎，删除了 hasLayout 原本的功能，因此彻底杜绝了很多深恶痛绝的 bug，但 IE8~IE11 通过「document.documentElement.currentStyle.hasLayout」依然可以获得 hasLayout 的标志，更详细的请看<a href="http://jhop.me/browsers/ie8/haslayout-true" target="_blank" rel="external">《IE8 haslayout = true》</a></p>
<p>IE8-11获取 hasLayout<br>综上所述：<br>在支持BFC的浏览器（IE8+，firefox，chrome，safari）通过创建新的BFC闭合浮动；<br>在不支持 BFC的浏览器 （IE6-7），通过触发 hasLayout 闭合浮动。</p>
<h2 id="四、闭合浮动方法——精益求精">四、闭合浮动方法——精益求精</h2>
<p>上面已经列举了7种闭合浮动的方法，通过第三节分析的原理，我们发现其实更多的：display：table-cell，display：inline-block等只要触发了BFC的属性值都可以闭合浮动。从各个方面比较，after伪元素闭合浮动无疑是相对比较好的解决方案了，下面详细说说该方法。</p>
<p>.clearfix:after {content:”.”; display:block; height:0; visibility:hidden; clear:both; }</p>
<p>.clearfix { *zoom:1; }</p>
<p>1) display:block 使生成的元素以块级元素显示,占满剩余空间;</p>
<p>2) height:0 避免生成内容破坏原有布局的高度。</p>
<p>3) visibility:hidden 使生成的内容不可见，并允许可能被生成内容盖住的内容可以进行点击和交互;</p>
<p>4）通过 content:”.”生成内容作为最后一个元素，至于content里面是点还是其他都是可以的，例如oocss里面就有经典的 content:”XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX”,有些版本可能content 里面内容为空,一丝冰凉是不推荐这样做的,firefox直到7.0 content:”” 仍然会产生额外的空隙；</p>
<p>5）zoom：1 触发IE hasLayout。</p>
<p>通过分析发现，除了clear：both用来闭合浮动的，其他代码无非都是为了隐藏掉content生成的内容，这也就是其他版本的闭合浮动为什么会有font-size：0，line-height：0。</p>
<h2 id="精益求精方案一：">精益求精方案一：</h2>
<p>相对于空标签闭合浮动的方法代码似乎还是有些冗余，通过查询发现Unicode字符里有一个“零宽度空格”，也就是U+200B ，这个字符本身是不可见的，所以我们完全可以省略掉 visibility:hidden了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.clearfix:after {content:<span class="string">"\200B"</span>; display:block; height:<span class="number">0</span>; clear:both; }</div><div class="line"></div><div class="line">.clearfix { *zoom:<span class="number">1</span>; }.</div></pre></td></tr></table></figure>

<h2 id="精益求精方案二：">精益求精方案二：</h2>
<p>由Nicolas Gallagher 大湿提出来的,原文:A new micro clearfix hack，该方法也不存在firefox中空隙的问题。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">/* For modern browsers */</div><div class="line"></div><div class="line">.cf:before,.cf:after {</div><div class="line"></div><div class="line">content:<span class="string">""</span>;</div><div class="line"></div><div class="line">display:table;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line">.cf:after { clear:both; }/* For IE <span class="number">6</span>/<span class="number">7</span> (trigger hasLayout) */</div><div class="line"></div><div class="line">.cf { zoom:<span class="number">1</span>; }</div></pre></td></tr></table></figure>

<p> 需要注意的是：</p>
<p>上面的方法用到了  ：before伪元素，很多人对这个有些迷惑，到底我什么时候需要用before呢？为什么方案一没有呢？其实它是用来处理margin边距重叠的，由于内部元素 float 创建了BFC，导致内部元素的margin-top和 上一个盒子的margin-bottom 发生叠加。如果这不是你所希望的，那么就可以加上before，如果只是单纯的闭合浮动，after就够了！并不是如同大漠<a href="http://www.w3cplus.com/css/clear-float" target="_blank" rel="external">《Clear Float》</a>一文所说的：但只使用clearfix:after时在跨浏览器兼容问题会存在一个垂直边距叠加的bug，这不是bug，是BFC应该有的特性。</p>
<p>进一步了解请看： <a href="http://www.iyunlu.com/view/css-xhtml/56.html" target="_blank" rel="external">《clearfix改良及overflow:hidden详解【译】》</a></p>
<p>在实际开发中，改进方案一由于存在Unicode字符不适合内嵌CSS的GB2312编码的页面，使用方案7完全可以解决我们的需求了，改进方案二等待大家的进一步实践。方案3、4通过overflow闭合浮动，实际上已经创建了新的 块级格式化上下文，这将导致其布局和相对于浮动的行为等发生一系列的变化，闭合浮动只不过是一系列变化中的一个作用而已。所以为了闭合浮动去改变全局特性，这是不明智的，带来的风险就是一系列的bug，比如firefox 早期版本产生 focus，截断绝对定位的层等等。始终要明白，如果单单只是需要闭合浮动，overflow就不要使用，而不是某些文章所说的“慎用”。</p>
<p>前前后后花了三天写完了这篇文章。如果觉得本文对您有帮助，您的留言就是对我最大的支持，同时由于精力有限，欢迎指出文中错误与不足，共勉之！</p>
<p>参考资料:</p>
<ul>
<li>Page breaks and block-formatting contexts: <a href="http://www.w3.org/TR/CSS21/page.html#allowed-page-breaks" target="_blank" rel="external">Allowed page breaks (13.3.3)</a></li>
<li>Clearfix and block formatting contexts: <a href="http://carsonified.com/blog/design/everything-you-know-about-clearfix-is-wrong/" target="_blank" rel="external">Everything you Know about Clearfix is Wrong</a></li>
<li><a href="http://dev.l-c-n.com/IEW/simulations.php" target="_blank" rel="external">Block formating contexts, “hasLayout” – IE Window vs CSS2.1 browsers: simulations.</a></li>
<li><a href="http://www.brunildo.org/test/FloatMarginOverflow.html" target="_blank" rel="external">New block formatting contexts next to floats</a></li>
<li><a href="http://www.communitymx.com/content/article.cfm?cid=6BC9D" target="_blank" rel="external">Control Block Formatting Context</a></li>
<li><a href="http://www.satzansatz.de/cssd/onhavinglayout.html" target="_blank" rel="external">On having layout</a>， [译文]On having layout <a href="http://old9.blogsome.com/2006/04/11/onhavinglayout" target="_blank" rel="external">http://old9.blogsome.com/2006/04/11/onhavinglayout</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/bb250481%28VS.85%29.aspx" target="_blank" rel="external">“HasLayout” Overview</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/ms533776%28VS.85%29.aspx" target="_blank" rel="external">hasLayout Property</a></li>
<li><a href="http://haslayout.net/haslayout" target="_blank" rel="external">IE hasLayout</a></li>
<li><a href="https://developer.mozilla.org/en/CSS/block_formatting_context" target="_blank" rel="external">https://developer.mozilla.org/en/CSS/block_formatting_context</a></li>
</ul>
<h2 id="说明">说明</h2>
<p>本篇转自：<a href="http://www.iyunlu.com/view/css-xhtml/55.html" target="_blank" rel="external">http://www.iyunlu.com/view/css-xhtml/55.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fredawang.github.io/2015/03/12/清除浮动/" data-id="lmkpy0frfk5ekrha" class="article-share-link" style="display:none">Share</a>
      
        <a href="http://fredawang.github.io/2015/03/12/清除浮动/#ds-thread" class="article-comment-link" style="display:none">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/">CSS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav-self">
  
  
    <a href="/2015/03/08/JavaScript关于OOP浅析/" id="article-nav-older-self" class="article-nav-link-wrap">
      <!--<strong class="article-nav-caption">Older</strong>-->
	  <div style="float:left; margin-right:10px;">
		上一篇
	  </div>
      <div class="article-nav-title">Javascript关于OOP浅析</div>
    </a>
  
  
    <a href="/2015/03/23/JavaScript 事件捕获和冒泡/" id="article-nav-newer-self" class="article-nav-link-wrap">
      <!--<strong class="article-nav-caption">Newer</strong>-->
	  <div style="float:left; margin-right:10px">
		下一篇
	  </div>
      <div class="article-nav-title">
        
          JavaScript事件捕获和冒泡
        
      </div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <!--<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>-->
  <!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="2015/03/12/清除浮动/" data-title="那些年我们一起清除过的浮动" data-url="http://fredawang.github.io/2015/03/12/清除浮动/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"freda"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Exemplar-Learning/">Exemplar Learning</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB-Essay/">WEB Essay</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/">JS</a><span class="tag-list-count">19</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/05/16/Chrome开发者工具之JavaScript内存分析/">Chrome开发者工具之JavaScript内存分析</a>
          </li>
        
          <li>
            <a href="/2015/04/26/深入理解javascript原型和闭包/">深入理解javascript原型和闭包</a>
          </li>
        
          <li>
            <a href="/2015/04/15/JavaScript作用域和作用域链/">JavaScript作用域和作用域链</a>
          </li>
        
          <li>
            <a href="/2015/04/14/SetTimeOut作用域/">SetTimeOut作用域分析</a>
          </li>
        
          <li>
            <a href="/2015/03/27/动态生成多级菜单/">动态生成多级菜单</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 水滴石穿<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'fredawang';
  
  var disqus_url = 'http://fredawang.github.io/2015/03/12/清除浮动/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>